@{
    ViewData["Title"] = "Template";
    Layout = "_TemplateLayout";
}


<div style="display: flex;justify-content: flex-end;">
    <button id="save-button" style="margin: 2px 2px;" class="btn btn-sm btn-primary">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-save" viewBox="0 0 16 16">
            <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1z" />
        </svg>
        Save
    </button>
    <button id="copy-button" style="margin: 2px 2px;" class="btn btn-sm btn-primary">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-copy" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1z" />
        </svg>
        Copy to Clipboard
    </button>
    <button id="export-button" style="margin: 2px 2px;" class="btn btn-sm btn-primary">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-filetype-html" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M14 4.5V11h-1V4.5h-2A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v9H2V2a2 2 0 0 1 2-2h5.5zm-9.736 7.35v3.999h-.791v-1.714H1.79v1.714H1V11.85h.791v1.626h1.682V11.85h.79Zm2.251.662v3.337h-.794v-3.337H4.588v-.662h3.064v.662zm2.176 3.337v-2.66h.038l.952 2.159h.516l.946-2.16h.038v2.661h.715V11.85h-.8l-1.14 2.596H9.93L8.79 11.85h-.805v3.999zm4.71-.674h1.696v.674H12.61V11.85h.79v3.325Z" />
        </svg>
        Export
    </button>
</div>
<div id="editor-container"></div>
<script src="//editor.unlayer.com/embed.js"></script>
<script>
    const editor = unlayer.createEditor({
        id: 'editor-container',
        displayMode: 'email'
    });

    function loadDynamicHtml(htmlContent) {
        const design = {
            "counters": {
                "uid": 1
            },
            "body": {
                "rows": [
                    {
                        "cells": [1],
                        "columns": [
                            {
                                "contents": [
                                    {
                                        "type": "text",
                                        "values": {
                                            "text": htmlContent
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
        };

        editor.loadDesign(design);
    }


    document.getElementById('copy-button').addEventListener('click', function () {
        editor.exportHtml(function (data) {
            navigator.clipboard.writeText(data.html).then(() => {
                alert("Copied to clipboard");
            }).catch(err => {
                console.error('Failed to copy text: ', err);
            });
        });
    });

    const dynamicHtmlContent = "<h1>Hello World</h1>";

    editor.addEventListener('editor:ready', function () {
        loadDynamicHtml(dynamicHtmlContent);
    });
</script>
